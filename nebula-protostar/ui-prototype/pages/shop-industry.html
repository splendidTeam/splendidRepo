<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>无标题文档</title>

<link rel="stylesheet" type="text/css" href="../css/main.css"/>
<link rel="stylesheet" type="text/css" href="../css/demo.css"/>

<script type="text/javascript" src="../scripts/jquery/jquery-1.9.1.js"></script>
<script type="text/javascript">
var $j = jQuery.noConflict();
</script>

<script type="text/javascript" src="../scripts/jquery/jquery-migrate-1.2.0.js"></script>
<script type="text/javascript" src="../scripts/jquery/jqueryui/jquery-ui-1.10.2.custom.js"></script>
<script type="text/javascript" src="../scripts/jquery/jqueryui/jquery-ui-timepicker-addon.js"></script>

<script type="text/javascript" src="../scripts/loxia2/jquery.loxiacore-2.js"></script>
<script type="text/javascript" src="../scripts/loxia2/jquery.loxiainput-2.js"></script>
<script type="text/javascript" src="../scripts/loxia2/jquery.loxiaselect-2.js"></script>
<script type="text/javascript" src="../scripts/loxia2/jquery.loxiatable-2.js"></script>
<script type="text/javascript" src="../scripts/loxia2/jquery.loxia.locale-zh-CN.js"></script>


<script type="text/javascript" src="../scripts/nebula/jquery.nebula.protostar-1.js"></script>
<script type="text/javascript" src="../scripts/jquery/ztree/jquery.ztree.all-3.5.js"></script>



<script type="text/javascript">


function formatGender(val){
	if(val == 0) return "正常";
	else return "禁用";
}

function editUser(data, args, idx){
	return "<a href='javascript:void(0);' class='func-button modify'>行业授权管理</a>";
}
var check=""

$j(document).ready(function(){
	loxia.init({debug: true, region: 'zh-CN'});
    nps.init();
	
	$j("#table1").loxiasimpletable({
		cols:
		[
			{name:"name",label:"店铺名称",width:"15%"},
			{name:"createtime",label:"创建时间",width:"10%"},
			{name:"status",label:"状态",width:"15%",template:"formatGender"},
			{label:"操作",width:"10%", template:"editUser"}
		]
	});

	refreshData();
			var setting = {
			check: {
				enable: true,
				chkboxType: {"Y":"", "N":""}
			},
			view: {
				dblClickExpand: true,
				showIcon:false
			},
			data: {
				simpleData: {
					enable: true
				}
			},
			callback: {
				beforeClick: beforeClick,
				onCheck: onCheck
			}
		};

		var zNodes =[
			{ id:1, pId:0, name:"鞋", open:true,nocheck:true},
			{ id:11, pId:1, name:"运动鞋"},
			{ id:12, pId:1, name:"休闲鞋"},
			{ id:2, pId:0, name:"服装", open:true,nocheck:true},
			{ id:21, pId:2, name:"T恤"},
			{ id:22, pId:2, name:"裤子"},
			{ id:23, pId:2, name:"卫衣"},
			{ id:3, pId:0, name:"配件", open:true,nocheck:true},
			{ id:31, pId:3, name:"帽子"},
			{ id:32, pId:3, name:"手套"},
			{ id:33, pId:3, name:"袜子"}
		 ];

		function beforeClick(treeId, treeNode) {
			var zTree = $j.fn.zTree.getZTreeObj("treeDemo");
			zTree.checkNode(treeNode, !treeNode.checked, null, true);
			return false;
		}
		
		function onCheck(e, treeId, treeNode) {
			var zTree = $j.fn.zTree.getZTreeObj("treeDemo"),
			nodes = zTree.getCheckedNodes(true),
			v = "";
			for (var i=0, l=nodes.length; i<l; i++) {
				v += nodes[i].id + ",";
			}
			if (v.length > 0 ) v = v.substring(0, v.length-1);
			check = v;
		}

		function showMenu() {
			var cityObj = $j(this);
			var cityOffset = $j(this).offset();
			$j("#menuContent").slideDown("fast");

			$j("body").bind("mousedown", onBodyDown);
		}
		function hideMenu() {
			$j("#menuContent").fadeOut("fast");
			$j("body").unbind("mousedown", onBodyDown);
		}
		function onBodyDown(event) {
			if (!(event.target.id == "menuBtn" || event.target.id == "citySel" || event.target.id == "menuContent" || $j(event.target).parents("#menuContent").length>0)) {
				hideMenu();
			}
		}

		
		$j.fn.zTree.init($j("#treeDemo"), setting, zNodes);
		$j(".func-button.modify").on("click", showMenu);
		$j(".button.orange.add").on("click", function() {
			alert(check);
			hideMenu();
		});
});


function refreshData(){
	$j("#table1").loxiasimpletable("refresh",
		[
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1},
			{name:"nike官方旗舰店",createtime:"2013-03-05",status:1}
		]
	);

    $j(".button.adduser").click(function(){
        window.location.href="add-user.html";
    });

    $j(".func-button.delete").on("click",function(){
        nps.confirm("确认删除","确定要删除选定的用户么？", function(){
            alert("Deleted");
            refreshData();
        });
    });
}

</script>

<script type="text/javascript" src="../scripts/main.js"></script>

</head>

<body>

<div class="content-box width-percent100">
	<div class="ui-title1">店铺行业
     
    </div>

    <table class="ui-block-content">
        <tr>
            <td><label>店铺名称：</label></td>
            <td>
                <span id="searchkeytext"><input type="text" loxiaType="input" mandatory="false"></input></span>
               
            </td>
            <td>
             <a href="#" class="func-button"><label class="ficon-true"></label><span>搜索</span></a> 
            </td>
        </tr>
    </table>
    
	<div class="percent30-content-left" style="width:70%">

    <div class="ui-block">
    	<div class="ui-block-title1">店铺列表</div>

   	 	<div class="border-grey ui-loxia-simple-table" id="table1"></div>   
    </div>
	</div>
	 <div class="percent70-content-right"  style="width:30%">
        	<div id="menuContent" class="menuContent border-grey" style="display:none;z-index:1000;background-color:#fff;">
		<div class="ui-block-title1">nike官方旗舰店
    </div>
	<ul id="treeDemo" class="ztree" style="margin-top:0; width:180px; height: 100%;"></ul>
</div>
        </div>

    


</div>
</body>
</html>
